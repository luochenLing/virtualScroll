(function(r,t){typeof exports=="object"&&typeof module<"u"?t(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],t):(r=typeof globalThis<"u"?globalThis:r||self,t(r.VirtualScroll={},r.vue))})(this,function(r,t){"use strict";const _={key:0},S=t.defineComponent({name:"llc-virtual-scroll"}),h=t.defineComponent({...S,props:{dataSet:{type:Array,required:!0},scrollBottomHandler:{type:Function},loadOrEndDataToolTip:{type:Object,default:"\u6B63\u5728\u52AA\u529B\u52A0\u8F7D\u4E2D..."}},emits:["scrollBottomHandler"],setup(n,{emit:d}){const l=n,o=t.reactive({itemCount:0,startIdx:0,curScorllTop:0}),a=t.ref(),s=t.ref();t.onMounted(async()=>{window.onresize=()=>{p()}}),t.onActivated(()=>{t.nextTick(()=>{a.value.scrollTop=o.curScorllTop})}),t.watch(()=>[l.dataSet,s.value],()=>{p()});const x=t.computed(()=>{let e=m();return l.dataSet.slice(e,f.value)}),f=t.computed(()=>{let e=o.startIdx+o.itemCount*2;return l.dataSet[e]||(e=l.dataSet.length-1),e}),y=t.computed(()=>{let e=m(),c=s.value?s.value[0]?.offsetHeight:100,i=(l.dataSet.length-f.value)*c;return{paddingTop:`${c*e}px`,paddingBottom:`${i}px`}}),p=()=>{let e=s.value?s.value[0]?.offsetHeight:100;o.itemCount=~~(a.value.offsetHeight/e)+2},B=async()=>{let c=1e3/30,i=Date.now();requestAnimationFrame(()=>{let u=Date.now();I(),u-i>=c&&(i=u,requestAnimationFrame(arguments.callee))})},I=async()=>{o.curScorllTop=a.value.scrollTop;let e=~~(a.value.scrollTop/s.value[0]?.offsetHeight);e!==o.startIdx&&(o.startIdx=e,o.startIdx+o.itemCount>l.dataSet.length-1&&(console.log("\u5230\u5E95\u4E86"),d("scrollBottomHandler")))},m=()=>{let e=0;return o.startIdx<=o.itemCount?e=0:e=o.startIdx-o.itemCount,e};return(e,c)=>(t.openBlock(),t.createElementBlock("article",{class:"visual-scroll",ref_key:"scrollRef",ref:a,onScrollPassive:B},[t.createElementVNode("div",{style:t.normalizeStyle(t.unref(y))},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(t.unref(x),(i,u)=>(t.openBlock(),t.createElementBlock("span",{class:"item",ref_for:!0,ref_key:"itemRef",ref:s},[t.renderSlot(e.$slots,"item",{data:i},void 0,!0)],512))),256)),l.dataSet.length>o.itemCount?(t.openBlock(),t.createElementBlock("div",_,[t.renderSlot(e.$slots,"toolTip",{},void 0,!0)])):t.createCommentVNode("",!0)],4)],544))}}),k="",g=(n=>(n.install=function(d){d.component(n.name,n)},n))(((n,d)=>{const l=n.__vccOpts||n;for(const[o,a]of d)l[o]=a;return l})(h,[["__scopeId","data-v-5210d8ac"]]));r.llcVirtualScroll=g,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=virtual-scroll.umd.js.map
